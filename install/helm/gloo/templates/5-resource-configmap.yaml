apiVersion: v1
kind: ConfigMap
metadata:
  name: gloo-custom-resource-config
  namespace: {{ .Release.Namespace }}
  labels:
    app: gloo
    gloo: custom-resources
data:
  {{- $cr := include "gloo.customResources" . | indent 4 -}}
  {{- $hasCr := contains "kind:" $cr -}}{{/* whether there are any custom resources */}}
  custom-resources: |
{{ $cr }}
    ---
    apiVersion: gateway.solo.io/v1
    kind: VirtualService
    metadata:
      name: default
      namespace: gloo-system
    spec:
      virtualHost: {}

  has-custom-resources: "{{- $hasCr -}}"
